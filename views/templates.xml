<?xml version="1.0"?>
<odoo>

    <template id="rednux_portal" name="RednuxPortalMyHome" inherit_id="account.portal_my_home_invoice" priority="60">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-if="invoice_count" t-call="portal.portal_docs_entry">
                <t t-set="title">new</t>
                <t t-set="url" t-value="'/my/purchase?filterby=new'"/>
                <t t-set="count" t-value="purchase_count_new"/>
            </t>

        </xpath>
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-if="invoice_count" t-call="portal.portal_docs_entry">
                <t t-set="title">confirmed
                </t>
                <t
                t-set="url" t-value="'/my/purchase?filterby=confirmed'"/>
           <t t-set="count" t-value="purchase_count_confirmed"/> 
            </t>

        </xpath>


        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-if="invoice_count" t-call="portal.portal_docs_entry">
                <t t-set="title">delivered</t>
                <t
                t-set="url" t-value="'/my/purchase?filterby=delivered'"/>
      <t t-set="count" t-value="purchase_count_delivered"/> 
            </t>

        </xpath>
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-if="invoice_count" t-call="portal.portal_docs_entry">
                <t t-set="title">billed
                </t>
                <t
                t-set="url" t-value="'/my/purchase?filterby=billed'"/>
             <t t-set="count" t-value="purchase_count_billed"/> 
            </t>

        </xpath>
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-if="invoice_count" t-call="portal.portal_docs_entry">
                <t t-set="title">paid</t>
                <t
                t-set="url" t-value="'/my/purchase?filterby=paid'"/>
                      <t t-set="count" t-value="purchase_count_paid"/> 
       
            </t>

        </xpath>



        <xpath expr="//div[hasclass('o_portal_my_home')]" position="after">
        <div class="row">
            <table>
                <thead>
                    <th></th>
                    <th>new</th>
                    <th>confirmed</th>
                    <th>ready for delivery</th>
                    <th>delivered</th>
                    <th>billed</th>
                </thead>
                <tbody>

                    <tr>
                        <td>total</td>
                        <td>adfsdafsdf</td>
                        <td>adfsdafsdf</td>
                        <td>adfsdafsdf</td>
                        <td>adfsdafsdf</td>
                        <td>adfsdafsdf</td>
                    </tr>

                    <tr>
                        <td>total value</td>
                        <td><span t-esc="x_lieferanten.x_studio_ordered"/></td>
                        <td><span t-esc="x_lieferanten.x_studio_confirmed"/></td>
                        <td><span t-esc="x_lieferanten.x_studio_ready_for_delivery"/></td>
                        <td><span t-esc="x_lieferanten.x_studio_delivered"/></td>
                        <td><span t-esc="x_lieferanten.x_studio_billed_count"/></td>
                    </tr>

                </tbody>
            </table>
            </div>
        </xpath>


    </template>

    <template id="rednux_portal_purchase_orders" name="Portal: My Purchase Orders" inherit_id="purchase.portal_my_purchase_orders" priority="64">
        <xpath expr="//thead" position="replace">
            <thead>
                <tr class="active">
                    <th>Purchase Orders #</th>
                    <th>Order Date</th>
                    <th>Brand</th>
                    <th/>
                    <th>Total</th>
                </tr>
            </thead>
        </xpath>
        <xpath expr="//tbody" position="replace">
            <t t-foreach="orders" t-as="order">
                <tr>
                    <td>
                        <a t-attf-href="/my/purchase/#{order.id}?#{keep_query()}"><t t-esc="order.name"/></a>
                    </td>
                    <td><span t-field="order.date_order"/></td>
                    <td>
                        <span t-esc="order.x_studio_marke"/></td>
                    <td>
                        <t t-if="order.invoice_status == 'to invoice'">
                            <span class="badge badge-info"><i class="fa fa-fw fa-file-text"/>
                                Waiting for Bill</span>
                        </t>
                        <t t-if="order.state == 'cancel'">
                            <span class="badge badge-secondary"><i class="fa fa-fw fa-remove"/>
                                Cancelled</span>
                        </t>
                    </td>

                    <td><span t-field="order.amount_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: order.currency_id}"/></td>
                </tr>
            </t>

        </xpath>
    </template>

    <template id="rednux_portal_purchase" name="RednuxPortal" inherit_id="vendor_purchase_order.portal_my_purchase_order_update_date" primary="True">
        <xpath expr="//div[hasclass('card-header')]" position="replace">
            <div class="card-header">
                <div class="row">
                    <div class="col-lg-12">
                        <h4>
                            <t t-if="order.state in ['draft', 'sent']">
                                Request for Quotation
                            </t>
                            <t t-else="1">
                                Purchase Order
                            </t>
                            <span t-esc="order.name"/>
                            <span t-esc="order.x_studio_status"/>
                        </h4>
                    </div>
                </div>
            </div>
        </xpath>
        <xpath expr="//div[hasclass('card-body')]" position="replace">
            <div class="card-body">
                <div class="mb-4">
                    <strong>Confirmation Date:</strong>
                    <span t-field="order.date_approve" t-options='{"widget": "date"}'/><br/>
                    <div t-att-class="'d-inline' if order.date_planned else 'd-none'">
                        <strong>Receipt Date:</strong><span class="ml-1" t-field="order.date_planned" t-options='{"widget": "date"}'/>
                    </div>
                </div>
                <h3 class="font-weight-normal">Pricing</h3>
                <table class="table table-sm">
                    <thead class="bg-100">
                        <tr>
                            <th>Products</th>
                            <th class="text-right d-none d-sm-table-cell">Unit Price</th>
                            <th class="text-right">Quantity</th>
                            <th class="text-right">Scheduled Date</th>
                            <th class="text-right" style="color:#3aadaa">
                                <strong>Update Dates Here</strong>
                            </th>
                            <th class="text-right">Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="order.order_line" t-as="ol">
                            <tr>
                                <td>
                                    <img t-att-src="image_data_uri(resize_to_48(ol.product_id.image_1024))" alt="Product" class="d-none d-lg-inline"/>
                                    <span t-esc="ol.name"/>
                                </td>
                                <td class="text-right d-none d-sm-table-cell">
                                    <span t-field="ol.price_unit" t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="ol.product_qty"/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="ol.date_planned.date()"/>
                                </td>
                                <td class="text-right">
                                    <form t-attf-action="/my/purchase/#{order.id}/update?access_token=#{order.access_token}" method="post">
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                        <div class="container">
                                            <div class="form-group">
                                                <div class="input-group date">
                                                    <input type="text" class="form-control datetimepicker-input o-purchase-datetimepicker" t-attf-id="datetimepicker_#{ol.id}" t-att-name="ol.id" data-toggle="datetimepicker" data-date-format="YYYY-MM-DD" t-attf-data-target="#datetimepicker_#{ol.id}"/>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </td>
                                <td class="text-right">
                                    <span t-field="ol.price_subtotal" t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>
                <div class="row">
                    <div class="col-sm-7 col-md-5 ml-auto">
                        <table class="table table-sm">
                            <tbody>
                                <tr>
                                    <td>
                                        <strong>Untaxed Amount:</strong>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="order.amount_untaxed" t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong>Taxes:</strong>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="order.amount_tax" t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <strong>Total:</strong>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="order.amount_total" t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </xpath>
    </template>
</odoo>
